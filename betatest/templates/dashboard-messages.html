{% extends "dashboard.html" %}

{% block page_title %}{{ message.title }}{% endblock %}

{% block dashboard %}
	{% if message %}
	<h4>{{ message.title }}</h4>
	<p>{{ message.message }}</p>
	{% elif messages %}
	<p>
		<ul class="tabs small-tabs">
			<li><a class="button" href="/dashboard/messages/new">New Message</a></li>
			<li><a class="button" href="/dashboard/messages/markread">Mark all as read</a></li>
		</ul>
	</p>
	<p>
	<form class="message-list-form">
		<ul class="message-list-ul">
		{% for message in messages %}
		<li>
			<div class="selection">
				<input type="checkbox" class="selection" name="message_action[]" value="{{ message.id }}" />
			</div>
			<div class="flags">
				- flags -
			</div>
			<div class="title">
				<a href="{{ url_for('show_message', message_id = message.id) }}">{{ message.title }}</a>
				<span class="meta">
					received {{ time(message.send_date, "send_date") }}
					from <a class="sender" href="{{ url_for('profile', username = message.sender.username) }}">{{ message.sender.username }}</a>
				</span>
			</div>
			<div class="message">
				{{ message.message }}
			</div>
		</li>
		{% endfor %}
		</ul>
		<input type="submit" name="delete" value="Delete" />
		<input type="submit" name="read" value="Mark as read" />
		<input type="submit" name="unread" value="Mark as unread" />
	</form>
	</p>
	{% elif newmessage %}
		<p>
		<form class="message-new-form">
			<p><label for="subject">Subject:</label><input type="text" name="subject" /></p>
			<p><label for="receiver">Receiver:</label><input type="text" name="receiver" /></p>
			<p><label for="message">Message:</label><textarea name="message"></textarea></p>
		</form>
		</p>
	{% else %}
		<p>Invalid call!</p>
	{% endif %}

{% endblock %}
